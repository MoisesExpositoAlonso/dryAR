---
title: Growth trajectories exploration, inference of germination and detection of
  missing pots
author: "Moises Exposito-Alonso (moisesexpositoalonso@gmail.com)"
date: '`r Sys.Date()`'
output:
  html_document: default
  #pdf_document: default
  #html_notebook: default
---


<!-- Define global options for knitr -->
```{r global_options, include=FALSE}
knitr::opts_chunk$set(
  #fig.width=12, fig.height=8, fig.path='Figs/',
  # echo=FALSE, warning=FALSE, message=FALSE
  root.dir='../'
  )
```



```{r}

library(dplyr);library(tidyr)
library(devtools)

load_all("~/mexposito/moiR/")
# library(moiR)
load_all(".")
# library(field)

## read harvesting info

tueh <- make_data_harvest(location="tuebingen")
madh <- make_data_harvest(location="madrid")
harvest<-rbind(madh,tueh)

head(harvest)
tail(harvest)
dim(harvest)
# harvest = select(harvest,-pathimage,-datelabeled)

# merge

data("genoreps")
head(genoreps)

harvest= merge(harvest,genoreps, by=c('qp','pos','site'),all.y=T)   ### NOTE ALSO THAT CAN BE SEVERAL PICTURES FOR A SINGLE POT!
head(harvest)

# put in the number column NA when it is an individual replicate
harvest$num[harvest$indpop == 'i']<-NA

harvest$num[harvest$num == 'missin']<-(-9)

# add quality flag
harvest$Harv.q <- 0
harvest$Harv.q[ !is.na(harvest$pathimage) ] <-1

unique(harvest$Harv.q)
unique(harvest$water)

head(harvest)
tail(harvest)
dim(harvest)

## save
print('The first lines of data index of harvest:')
head(harvest,n=5)

devtools::use_data(harvest,overwrite = T)


```
